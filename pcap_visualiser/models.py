from django.db import models


class PcapFile(models.Model):
    geo_database_choices = [('GeoLite2-City.mmdb', 'GeoLite2-City.mmdb'), ('GeoLite2-Country.mmdb', 'GeoLite2-Country.mmdb'), ('GeoLite2-ASN.mmdb', 'GeoLite2-ASN.mmdb')]
    pcap_file = models.FileField(upload_to='uploads/pcap')
    layer = models.PositiveIntegerField(choices=[(2, "layer 2"), (3, "layer 3"), (4, "layer 4")], default=2)
    layout = models.CharField(choices=[('dot', 'Dot'), ('sfdp', 'Sfdp')], default='dot', max_length=10)
    shape = models.CharField(choices=[('circle', 'Circle'), ('diamond', 'Diamond'), ('box', 'Box')], default='circle', max_length=10)
    nmax = models.PositiveIntegerField(default=100)
    geo_database = models.CharField(choices=geo_database_choices, default='GeoLite2-City.mmdb', max_length=30)

    def __str__(self):
        return self.pcap_file.name
